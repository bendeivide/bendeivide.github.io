---
title: "Estat√≠stica e Probabilidade"
subtitle: "Aula 07 - Medidas de dispers√£o"
title-slide-attributes:
    data-background-image: cap.png

author: "{{< fa user-tie >}} [Ben D√™ivide](http://bendeivide.github.io) | {{< fa school >}} [UFSJ](https://www.ufsj.edu.br/)"
bibliography: biblio.bib
link-citations: true
csl: associacao-brasileira-de-normas-tecnicas-ipea.csl
lang: "pt-br"
format: 
  revealjs:
    navigation-mode: vertical # Slides horizontais e verticais
    theme: [dark, ben-slide.scss]
    transition: slide
    background-transition: fade
#    transition-speed: fade
    footer: "[EPAEC](https://bendeivide.github.io/courses/epaec/) | <https://bendeivide.github.io/>" # Rodap√©
    incremental: true # Transi√ß√£o de itens gradativos
    controls: true # Inserindo as flechas de transicao
    # Quadro negro
    chalkboard: 
      theme: whiteboard
      #chalk-width: 5 # largura da caneta do quadro negro
      boardmarker-width: 3 # largura da caneta do quadro branco
    multiplex: true # Efeito para quando eu mudar o slide, todos observarao mudando em seus browsers tbm
    logo: ben.png
#   slide-tone: true # som na transicao dos slides
    slide-number: true # Inserindo numero nos slides
#    show-slide-number: print
    menu:
      side: left # lado do menu
      width: wide
#     numbers: true # inserir numero nos itens do menu
    pointer: # Plugin para o ponteiro
      - key: q
      - color: red
      - pointerSize: 16
      - alwaysVisible: false
revealjs-plugins:
  - pointer
editor: source
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(leem)
```

# Filosofia de publica√ß√£o (Selo DC) {background-image="cap02.png"}

<a href="https://bendeivide.github.io/dc/" target="_blank" style="text-align: center;">

<img src="SeloDC-branco.png" width = "400">

</a>

# Livro de Apoio {background-image="cap02.png"}

Usaremos @batista2023:

<a href="https://bendeivide.github.io/books/epaec/" target="_blank" style="text-align: center;">

<img src="hardcover.png" width = "300">

</a>

# Motiva√ß√£o inicial {background-image="cap02.png"}

```{r, echo = TRUE, eval = TRUE}
# Dados dos grupos gerados
set.seed(10); gA <- rnorm(10, mean = 10, sd = 2)
set.seed(10); gB <- rnorm(9, mean = 10, sd = 4)
gC <- c(4.706090, 4.772017, 6.404994, 7.338766, 
        7.817944, 8.372813, 8.894485, 10.112477, 
        11.767271, 20.000000)

# Media do grupo gA
(media.gA <- mean(gA))

# gerando gB[10] e media de gB
gB[10] <- length(gA) * media.gA - sum(gB)
(media.gB <- mean(gB))


# gerando gC[10] e media de gC
(media.gC <- mean(gC))
```

## Motiva√ß√£o inicial {background-image="cap02.png"}


```{r, echo = TRUE, eval = TRUE}
# Apresentando os dados
cbind(sort(gA), sort(gB), sort(gC))
```

# Ideia sobre medidas de dispers√£o {background-image="cap02.png"}

Vamos usar o `leem`!

. . .

:::: {.columns}

::: {.column width="50%"}

```r
library(leem)
showpar()
```

:::

::: {.column width="50%"}

<center>

<img src="leem.png" title="Imagens: Logo leem" width = "500">

</center>

:::

::::


# Tipos de medidas de dispers√£o {background-image="cap02.png"}

- Amplitude
- Desvio m√©dio
- M√≥dulo do desvio
- Soma de quadrado dos desvios
- Vari√¢ncia
- Desvio padr√£o
- Coeficiente de varia√ß√£o
- Erro padr√£o da m√©dia


# Exemplos: Dados n√£o agrupados {background-image="cap02.png"}

::: {.nonincremental}

<font size="+3">

1. Considere a distribui√ß√£o de frequ√™ncia do n√∫mero de erros encontrados em 20 conjunto de caracteres monitorado em um canal de comunica√ß√£o:



```{r, echo=FALSE, warning=FALSE}
d1 <- c( 3,     1,    0 ,   1,    3  ,  2 ,   4,    1  ,  3 ,   1,
 1 ,    1   , 2 ,   3  ,  3  ,  2  ,  0   , 2 ,   0,    1
)
dados <- matrix(sort(d1), 2, 10, byrow = TRUE)
knitr::kable(
  dados, longtable = TRUE, booktabs = TRUE,
  caption = NULL
)
```



2. Os dados representam a temperatura (¬∞F) do anel de veda√ß√£o de cada teste de acionamento ou lan√ßamento real do motor do foguete Challenger.



```{r, echo=FALSE, warning=FALSE, }
d2 <- read.table("https://raw.githubusercontent.com/bendeivide/book-epaec/master/dados/cap02/dados_exem2.1.txt", h = TRUE)
d3 <- d2$chal
dados <- matrix(sort(d3), 3, 12, byrow = TRUE)
knitr::kable(
  dados, longtable = TRUE, booktabs = TRUE,
  caption = NULL
)
```

</font>

:::

## Exemplos: Dados agrupados {background-image="cap02.png"}

<font size="+2">

:::: {.columns}
::: {.column width="50%"}
Exemplo 1

```{r, echo = FALSE, eval = TRUE}
## Usando o operador 'pipe' nativo
d1 |> new_leem(variable = 1) |> tabfreq()
```
:::
::: {.column width="50%"}
Exemplo 2

```{r, echo = FALSE, eval = TRUE}
## Usando o operador 'pipe' nativo
d3 |> new_leem(variable = 2) |> tabfreq()
```
:::

::::

</font>




# Amplitude (Dados n√£o agrupados) {background-image="cap02.png"}

> **Defini√ß√£o (Amplitude):** Seja uma amostra $X_1$, $X_2$, $\ldots$, $X_n$, de tamanho $n$, e em ordem crescente de magnitude temos $X_{(1)} = \min\limits_{i}(X_i)$, $X_{(2)}$, $\ldots$, $X_{(n)} = \max\limits_{i}(X_i)$, para $i$ $=$ $1$, $2$, $\ldots$, $n$. Ent√£o a amplitude de uma popula√ß√£o, denotada por $A$, √© definida por:
  \begin{align}
    A & = X_{(n)} - X_{(1)}.
  \end{align}

## Amplitude (Dados agrupados) {background-image="cap02.png"}

<font size="+3">

> **Defini√ß√£o (Amplitude):** Seja uma amostra $X_1$, $X_2$, \ldots, $X_n$, de tamanho $n$, agrupados em $k$ grupos com vari√°veis $X_i$ e $F_i$ frequ√™ncias, ou $k$ classes com pontos m√©dios $\tilde{X}_i$ e $F_i$ frequ√™ncias, para $i$ $=$ $1$, $2$, $\ldots$, $k$ e $\sum_{i = 1}^{k}F_i = n$, ent√£o a amplitude de uma amostra, denotada por $A$, √© definida por:
\begin{align}
    A & = \left\{\begin{array}{ll}
                   X_{(k)} - X_{(1)}, &  \textrm{Agrupados sem intervalo de classe}, \\
                   \tilde{X}_{(k)} - \tilde{X}_{(1)}, & \textrm{Agrupados com intervalo de classe},\\
                 \end{array}\right.
  \end{align}
em que $X_{(k)} = \max\limits_{i}(X_i)$, $X_{(1)} = \min\limits_{i}(X_i)$, $\tilde{X}_{(k)} = \max\limits_{i}(\tilde{X}_{i})$, $\tilde{X}_{(1)} = \min\limits_{i}(\tilde{X}_{i})$, sendo $\tilde{X}_{i}$ o ponto m√©dio das classes.
  
</font>


## Aplica√ß√£o {background-image="cap02.png"}



Exemplo 1:

. . . 

Dados n√£o agrupados
\begin{align*}
  A = 4 - 0 = 4~\textrm{erros}.
\end{align*}

Dados agrupados
\begin{align*}
  A = 4 - 0 = 4~\textrm{erros}.
\end{align*}


## Aplica√ß√£o {background-image="cap02.png"}

Exemplo 2:

. . . 

Dados n√£o agrupados
\begin{align*}
  A = 84,0 - 31,0 = 53,0~\textrm{¬∞F}.
\end{align*}

Dados agrupados
\begin{align*}
  A = 84,0 - 31,0 = 53,0~\textrm{¬∞F}.
\end{align*}

OBS.: Apesar dos valores iguais, isso nem sempre ocorre!

## Usando o `leem` {background-image="cap02.png"}

<font size="+3">

Exemplo 1: Dados n√£o agrupados

. . . 

```{.r code-line-numbers="7|1-7"}
# Dados n√£o agrupados
d1 <- read.table("https://raw.githubusercontent.com/bendeivide/book-epaec/master/dados/cap02/tabela2.1.txt", header = TRUE)
d1 <- d1$erros
# Amplitude
d1 |> 
  new_leem(variable = 1) |> 
  amplitude(grouped = FALSE)
```
```{r echo=FALSE}
# Dados n√£o agrupados
d1 <- read.table("https://raw.githubusercontent.com/bendeivide/book-epaec/master/dados/cap02/tabela2.1.txt", header = TRUE)
d1 <- d1$erros
# Amplitude
d1 |> 
  new_leem(variable = 1) |> 
  amplitude(grouped = FALSE)
```

. . .

Exemplos 1: Dados agrupados

. . .

```{.r code-line-numbers="4|1-4"}
# Amplitude: Dados agrupados
d1 |> 
  new_leem(variable = 1) |> 
  amplitude(grouped = TRUE)
```
```{r, echo=FALSE}
# Dados n√£o agrupados
d1 <- read.table("https://raw.githubusercontent.com/bendeivide/book-epaec/master/dados/cap02/tabela2.1.txt", header = TRUE)
d1 <- d1$erros
# Amplitude
d1 |> 
  new_leem(variable = 1) |> 
  amplitude(grouped = TRUE)
```

</font>


## Usando o `leem` {background-image="cap02.png"}

<font size="+3">

Exemplo 2: Dados n√£o agrupados

. . . 

```{.r code-line-numbers="7|1-7"}
# Dados n√£o agrupados
d2 <- read.table("https://raw.githubusercontent.com/bendeivide/book-epaec/master/dados/cap02/dados_exem2.1.txt", header = TRUE)
d2 <- d2$challenger
# Amplitude
d2 |> 
  new_leem(variable = 2) |> 
  amplitude(grouped = FALSE)
```
```{r echo=FALSE}
# Dados n√£o agrupados
d2 <- read.table("https://raw.githubusercontent.com/bendeivide/book-epaec/master/dados/cap02/dados_exem2.1.txt", header = TRUE)
d2 <- d2$challenger
# Amplitude
d2 |> 
  new_leem(variable = 2) |> 
  amplitude(grouped = FALSE)
```

. . .

Exemplos 2: Dados agrupados

. . .

```{.r code-line-numbers="4|1-4"}
# Amplitude: Dados agrupados
d2 |> 
  new_leem(variable = 2) |> 
  amplitude(grouped = TRUE)
```
```{r, echo=FALSE}
# Dados agrupados
# Amplitude
d2 |> 
  new_leem(variable = 2) |> 
  amplitude(grouped = TRUE)
```

</font>

## Retornando a motiva√ß√£o {background-image="cap02.png"}
</br>
</br>
</br>
<style type="text/css">
.tg  {border:none;border-collapse:collapse;border-spacing:0;}
.tg td{border-style:solid;border-width:0px;font-family:Arial, sans-serif;font-size:30px;overflow:hidden;
  padding:10px 5px;word-break:normal;}
.tg th{border-style:solid;border-width:0px;font-family:Arial, sans-serif;font-size:30px;font-weight:normal;
  overflow:hidden;padding:10px 5px;word-break:normal;}
.tg .tg-lvop{background-color:#34cdf9;border-color:inherit;font-weight:bold;text-align:center;vertical-align:top}
.tg .tg-c3ow{border-color:inherit;text-align:center;vertical-align:top}
</style>
<table class="tg">
<thead>
  <tr>
    <th class="tg-lvop">Grupo</th>
    <th class="tg-lvop">Amplitude</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td class="tg-c3ow">gA</td>
    <td class="tg-c3ow">$A = 10,77959 - 6,746655 = 4,032934~und.$</td>
  </tr>
  <tr>
    <td class="tg-c3ow">gB</td>
    <td class="tg-c3ow">$A = 18,787223 - 3,493309 = 15,29391~und.$</td>
  </tr>
  <tr>
    <td class="tg-c3ow">gC</td>
    <td class="tg-c3ow">$A = 20 - 4,706090 = 15,29391~und.$</td>
  </tr>
</tbody>
</table>

## Caracter√≠sticas da amplitude {background-image="cap02.png"}

- O resultado da amplitude √© dado na mesma unidade da vari√°vel em estudo;
-  Uma medida de dispers√£o facilmente calculada;
- Limitada apenas as vari√°veis quantitativas;
- Essa medida √© muito utilizada em compara√ß√µes m√∫ltiplas, cartas de controle em estat√≠stica de qualidade, dentre outras √°reas;

## Caracter√≠sticas da amplitude (continua√ß√£o...) {background-image="cap02.png"}

- A amplitude pode ser utilizada como medida de dispers√£o para comparar a variabilidade de dados de dois ou mais grupos diferentes;
- A amplitude √© sens√≠vel a dados discrepantes\footnote{Entendemos por dados discrepantes, as observa√ß√µes que est√£o distantes da massa de dados (maior parte dos dados). Esses dados quando influenciam as an√°lises estat√≠sticas, dizemos que estes dados s√£o influentes.};

## Caracter√≠sticas da amplitude (continua√ß√£o...) {background-image="cap02.png"}

- A amplitude √© limitada por levar em considera√ß√£o apenas os valores extremos, e nada sobre as demais observa√ß√µes. Nesse caso, podem ocorrer situa√ß√µes como os apresentados no Exemplo de motiva√ß√£o, em que poder√≠amos erroneamente concluir que os grupos de dados \code{gB} e \code{gC} s√£o iguais, uma vez que apresentam amplitude e m√©dia aritm√©tica iguais;

## Caracter√≠sticas da amplitude (continua√ß√£o...) {background-image="cap02.png"}

- Segundo @Ferreira2009, a amplitude amostral, substima a amplitude populacional, uma vez que √© pouco prov√°vel que uma amostra contenha os valores m√≠nimo e m√°ximo da popula√ß√£o, portanto, a amplitude amostral √© um estimador^[Entendemos por estimador uma fun√ß√£o que depende apenas dos dados amostrais e que ir√° representar um par√¢metro (caracter√≠stica populacional) desconhecida.] viesado^[Dizemos que um estimador √© viesado se a esperan√ßa matem√°tica desse estimador √© diferente do par√¢metro de interesse.] e ineficiente.



## Propriedades da amplitude {background-image="cap02.png"}

<font size="+3">

> **Teorema:** Baseado na Defini√ß√£o da amplitude amostral, e considerando $c$ uma constante, ent√£o:
>
> - Se para uma amostra $X_1$, $X_2$, $\ldots$, $X_n$, a amplitude √© dada por $A_X = X_{(n)} - X_{(1)}$, ent√£o para uma transforma√ß√£o de $Y_i = X_i \pm c$, para $i$ $=$ $1$, $2$, $\ldots$, $n$,  a nova amplitude n√£o se altera, isto √©, $A_Y = A_X$.
> - Se para uma amostra $X_1$, $X_2$, $\ldots$, $X_n$, a amplitude √© dada por $A_X = X_{(n)} - X_{(1)}$, ent√£o para uma transforma√ß√£o de $Y_i = X_i \times c$, para $i$ $=$ $1$, $2$, $\ldots$, $n$, a nova amplitude √© dada por $A_Y = A_X \times c$. Esse resultado vale tamb√©m para a transforma√ß√£o $Y_i = X_i / m$, sendo $m$ tamb√©m uma constante. Basta usar $c = 1 / m$ e o resultado √© o mesmo.

</font>

# Vari√¢ncia {background-image="cap02.png"}

<font size="+3">

Considerando uma popula√ß√£o $X_1$, $X_2$, $\ldots$, $X_N$ e sua respectiva amostra $X_1$, $X_2$, $\ldots$, $X_n$, podemos considerar inicialmente o desvio m√©dio como outra medida de dispers√£o, dada por:

. . .

\begin{align}
  DM_p & = \sum_{i = 1}^{N} \left(X_i - \mu \right), \quad \textrm{(Populacional)}
\end{align}
em que $\mu = \sum_{i = 1}^{N} X_i / N$, e seu respectivo estimador √© dado por:

. . .

\begin{align}
  DM & = \sum_{i = 1}^{n} \left(X_i - \bar{X} \right), \quad \textrm{(Amostral)}
\end{align}
em que $\bar{X} = \sum_{i = 1}^{n} X_i / n$.

</font>

## Vari√¢ncia {background-image="cap02.png"}

<font size="+3">

As express√µes anteriores apresentam alguns problemas pr√°ticos!!!

. . .

Para isso, podemos contornar essa situa√ß√£o inserindo uma fun√ß√£o modular nessa medida anterior, e criar o m√≥dulo do desvio, dada por:

. . . 

\begin{align}
  S_{|\mu|} & = \sum_{i = 1}^{N} \left|X_i - \mu \right|, \quad \textrm{(Populacional)}
\end{align}
e

. . .

\begin{align}
  S_{|\bar{X}|} & = \sum_{i = 1}^{n} \left|X_i - \bar{X} \right|. \quad \textrm{(Amostral)}
\end{align}


</font>


## Vari√¢ncia {background-image="cap02.png"}

<font size="+2">

As express√µes anteriores apresentam alguns problemas pr√°ticos!!!

. . .

Da√≠, surge uma outra medida de variabilidade que √© a soma de quadrados, dada por:
\begin{align}\label{eq:desvquadpop}
  SQ_{p} & = \sum_{i = 1}^{N} \left(X_i - \mu \right)^2, \quad \textrm{(Populacional)}
\end{align}
e
\begin{align}
  SQ & = \sum_{i = 1}^{n} \left(X_i - \bar{X} \right)^2. \quad \textrm{(Amostral)}
\end{align}

. . .

Percebemos que a soma de quadrados amostral pode ser tamb√©m expressa por:
\begin{align}
  SQ & = \displaystyle\sum_{i = 1}^{n}X_i^2 - \frac{1}{n} \left(\sum_{i = 1}^{n}X_i\right)^2,
\end{align}


</font>


## Vari√¢ncia {background-image="cap02.png"}

<font size="+2">

**Defini√ß√£o (Vari√¢ncia populacional): ** Seja uma popula√ß√£o $X_1$, $X_2$, $\ldots$, $X_N$, de tamanho $N$, com par√¢metro conhecido $\mu = \sum_{i = 1}^{N} X_i / N$, ent√£o a vari√¢ncia populacional, denotada por $\sigma^2$, √© definida por:
\begin{align}
  \sigma^2 & = \frac{SQ_p}{N},
\end{align}
em que $SQ_p$ √© dado pela express√£o anterior, ou de forma similar,

. . .

\begin{align}
    \sigma^2 & = \frac{\displaystyle\sum_{i = 1}^{N}X_i^2 - \frac{1}{N} \left(\sum_{i = 1}^{N}X_i\right)^2}{N}.
\end{align}

. . .

Intuitivamente, poder√≠amos pensar para a condi√ß√£o amostral:

\begin{align}
  \hat{\sigma}^2 & = \frac{SQ}{n}.
\end{align}

</font>

## Vari√¢ncia {background-image="cap02.png"}

<font size="+3">

**Defini√ß√£o (Vari√¢ncia amostral):** Seja uma popula√ß√£o $X_1$, $X_2$, \ldots, $X_n$, de tamanho $n$, com $\bar{X} = \sum_{i = 1}^{n} X_i / n$, ent√£o a vari√¢ncia amostral, denotada por $S^2$, √© definida como:
  \begin{align}\label{eq:varamost2}
    S^2 & = \frac{SQ}{n - 1},
  \end{align}
em que $SQ$ √© dado pela express√£o anterior, ou de forma similar, 

. . .

\begin{align}\label{eq:varamost3}
    S^2 & = \frac{\displaystyle\sum_{i = 1}^{n}X_i^2 - \frac{1}{n} ~\left(\sum_{i = 1}^{n}X_i\right)^2}{n - 1}.
\end{align}

</font>

## Exemplo motivacional {background-image="cap02.png"}

<font size="+2">

- Vari√¢ncia amostral para o grupo gA:

. . .

\begin{align*}
    S^2_{\textrm{gA}} & = \frac{6,746655^2 + \ldots + 10,779589^2 - 1 / 10 \times \left(6,746655 +  \ldots + 10,779589 \right)^2}{10 - 1}\\
                    & = \frac{831,0017 - 8133,67 / 10}{9}\\
                    & = 1,959404~und^2
\end{align*}

. . . 

- Vari√¢ncia amostral para o grupo gB:

. . .


\begin{align*}
    S^2_{\textrm{gB}} & = \frac{3,493309^2 + \ldots + 18,787223^2 - 1 / 10 \times \left(3,493309 +  \ldots + 18,787223 \right)^2}{10 - 1}\\
                    & = \frac{988,9577 - 8133,67 / 10}{9}\\
                    & = 19,51007~und^2
\end{align*}


## Exemplo motivacional {background-image="cap02.png"}


- Vari√¢ncia amostral para o grupo gC:

. . .

\begin{align*}
    S^2_{\textrm{gC}} & = \frac{4,706090^2 + \ldots + 20,000000^2 - 1 / 10 \times \left(4,706090 +  \ldots + 20,000000 \right)^2}{10 - 1}\\
                    & = \frac{990,8678 - 8133,67 / 10}{9}\\
                    & = 19,72232~und^2
  \end{align*}

</font>

## Vari√¢ncia (Dados agrupados) {background-image="cap02.png"}

<font size="+3">

**Defini√ß√£o (Vari√¢ncia p/ dados agrupados):** Seja uma amostra $X_1$, $X_2$, \ldots, $X_n$, de tamanho $n$, agrupados em $k$ grupos com vari√°veis $X_i$ e frequ√™ncia $F_i$, ou $k$ classes com pontos m√©dios $\tilde{X}_i$ e $F_i$ frequ√™ncias, para $i$ $=$ $1$, $2$, $\ldots$, $k$ e $\sum_{i = 1}^{k}F_i = n$, ent√£o a vari√¢ncia de uma amostra, denotada por $S^2$, √© definida por:
  \begin{align}\label{eq:varagrupados}
    S^2 & = \left\{\begin{array}{ll}
                   \frac{\sum_{i = 1}^{k}(X_i - \bar{X})^2\times F_i}{\sum_{i = 1}^{k}F_i - 1}, &  \textrm{agrupados sem intervalo de classe}, \\
                   &\\
                   \frac{\sum_{i = 1}^{k}(\tilde{X}_i - \bar{\tilde{X}})^2\times F_i}{\sum_{i = 1}^{k}F_i - 1}, &  \textrm{agrupados com intervalo de classe},\\
                 \end{array}\right.
  \end{align}
sendo $\tilde{X}_{i}$ o ponto m√©dio das classes, $\bar{X} = \sum_{i = 1}^{k} X_iF_i / \sum_{i = 1}^{k}F_i$ e $\bar{\tilde{X}} = \sum_{i = 1}^{k} \tilde{X}_iF_i / \sum_{i = 1}^{k}F_i$, 

</font>

## Vari√¢ncia (Dados agrupados) {background-image="cap02.png"}

<font size="+3">

**Defini√ß√£o (Vari√¢ncia p/ dados agrupados):** ou se forma similar,
  \begin{align}\label{eq:varagrupados2}
    S^2 & = \left\{\begin{array}{ll}
                  \frac{\sum_{i = 1}^{k}X_i^2\times F_i - \frac{1}{\sum_{i = 1}^{k} F_i}(\sum_{i = 1}^{k} X_iF_i)^2}{\sum_{i = 1}^{k}F_i - 1}, &  \textrm{agrup. s/ intervalo de classe}, \\
                  & \\
                  \frac{\sum_{i = 1}^{k}\tilde{X}_i^2\times F_i - \frac{1}{\sum_{i = 1}^{k} F_i}(\sum_{i = 1}^{k} \tilde{X}_iF_i)^2}{\sum_{i = 1}^{k}F_i - 1}, &  \textrm{agrup. c/ intervalo de classe}. \\
                 \end{array}\right.
  \end{align}

</font>

## Aplica√ß√£o {background-image="cap02.png"}

Exemplo 1:

. . .

<font size="+2">

:::: {.columns}
::: {.column width="40%"}


```{r, echo = FALSE, eval = TRUE}
## Usando o operador 'pipe' nativo
d1 |> new_leem(variable = 1) |> tabfreq()
```
:::
::: {.column width="60%"}

<font size="+2">

\begin{align}
S^2 & = \frac{0^2 \times 3 + \ldots + 4^2 \times 1 - (1/20) \times (0 \times 3 + \ldots + 4 \times 1)^2}{20 - 1}\\
    & = 1,38~\textrm{unid.}^2
\end{align}

</font>

:::

::::

</font>

## Aplica√ß√£o {background-image="cap02.png"}

Exemplo 2:

. . .

<font size="+2">

:::: {.columns}
::: {.column width="50%"}


```{r, echo = FALSE, eval = TRUE}
## Usando o operador 'pipe' nativo
d2 |> new_leem(variable = 2) |> tabfreq()
```
:::
::: {.column width="50%"}


<font size="+1">

Dados agrupados

\begin{align}
S^2 & = \frac{31^2 \times 1 + \ldots + 84^2 \times 5 - (1/36) \times (31 \times 1 + \ldots + 84 \times 5)^2}{36 - 1}\\
    & = 159,355~\textrm{unid.}^2
\end{align}


Dados n√£o agrupados

\begin{align}
S^2 & = \frac{31^2 + \ldots + 84^2 - (1/36) \times (31 + \ldots + 84)^2}{36 - 1}\\
    & = 147,84~\textrm{unid.}^2
\end{align}

</font>

:::

::::

</font>


## Usando o `leem` {background-image="cap02.png"}

<font size="+3">

Exemplo 1: Dados n√£o agrupados

. . . 

```{.r code-line-numbers="4|1-4"}
# Variancia - Dados nao agrupados
d1 |> 
  new_leem(variable = 1) |> 
  variance(grouped = FALSE)
```
```{r echo=FALSE}
# Variancia - Dados nao agrupados
d1 |> 
  new_leem(variable = 1) |> 
  variance(grouped = FALSE)
```

. . .

Exemplos 1: Dados agrupados

. . .

```{.r code-line-numbers="4|1-4"}
# Variance: Dados agrupados
d1 |> 
  new_leem(variable = 1) |> 
  variance(grouped = TRUE)
```
```{r, echo=FALSE}
# Variance - Dados nao agrupados
d1 |> 
  new_leem(variable = 1) |> 
  variance(grouped = TRUE)
```

</font>


## Usando o `leem` {background-image="cap02.png"}

<font size="+3">

Exemplo 2: Dados n√£o agrupados

. . . 

```{.r code-line-numbers="4|1-4"}
# Variancia - Dados n√£o agrupados
d2 |> 
  new_leem(variable = 2) |> 
  variance(grouped = FALSE)
```
```{r echo=FALSE}
# Variancia - Dados n√£o agrupados
d2 |> 
  new_leem(variable = 2) |> 
  variance(grouped = FALSE)
```

. . .

Exemplos 2: Dados agrupados

. . .

```{.r code-line-numbers="4|1-4"}
# Variancia: Dados agrupados
d2 |> 
  new_leem(variable = 2) |> 
  variance(grouped = TRUE)
```
```{r, echo=FALSE}
# Variancia - Dados agrupados
d2 |> 
  new_leem(variable = 2) |> 
  variance(grouped = TRUE)
```

</font>


## Caracter√≠sticas da vari√¢ncia {background-image="cap02.png"}

- A unidade da vari√¢ncia est√° na escala ao quadrado da unidade da vari√°vel;
- limitada apenas as vari√°veis quantitativas;
- a vari√¢ncia √© sempre uma medida positiva, exceto quando todos os valores s√£o iguais que resultam em uma vari√¢ncia nula;
- quanto mais pr√≥ximo de zero a vari√¢ncia for, mas concentrado os dados est√£o em torno da m√©dia, ao passo que, √† medida que a vari√¢ncia se distancia de zero, mas disperso os dados est√£o em torno da m√©dia;

## Caracter√≠sticas da vari√¢ncia {background-image="cap02.png"}


- devido as suas propriedades matem√°ticas, algumas mencionadas anteriormente, bem como a quantidade de t√©cnicas estat√≠sticas que empregam essa medida, a torna como a mais conhecida dentre as medidas de dispers√£o;
- uma vez que a m√©dia √© sens√≠vel aos dados, a vari√¢ncia tamb√©m √© sens√≠vel, uma vez que esta depende da m√©dia.


## Propriedades da vari√¢ncia {background-image="cap02.png"}

<font size="+3">

>**Teorema:** Baseado na Defini√ß√£o sobre a vari√¢ncia, e considerando $c$ uma constante, ent√£o:
>
>I) Se para uma amostra $X_1$, $X_2$, $\ldots$, $X_n$, a vari√¢ncia √© dada por $S^2_X$, ent√£o para uma transforma√ß√£o de $Y_i = X_i \pm c$, para $i$ $=$ $1$, $2$, $\ldots$, $n$, ent√£o a nova vari√¢ncia n√£o se altera, isto √©, $S^2_Y = S^2_X$.
>
>II) Se para uma amostra $X_1$, $X_2$, $\ldots$, $X_n$, a vari√¢ncia √© dada por $S^2_X$, ent√£o para uma transforma√ß√£o de $Y_i = X_i \times c$, para $i$ $=$ $1$, $2$, $\ldots$, $n$, ent√£o a nova vari√¢ncia √© dada por $S^2_Y = c^2\times S^2_X$. Esse resultado vale tamb√©m para a transforma√ß√£o $Y_i = X_i / m$, sendo $m$ tamb√©m uma constante. Basta usar $c = 1 / m$ e o resultado √© o mesmo.

</font>

# Desvio padr√£o {background-image="cap02.png"}

- A vari√¢ncia apesar de ter resolvido alguns dos problemas, apresenta sua unidade ao quadrado da unidade da vari√°vel em estudo;
- isso significa que se tivermos usando uma vari√°vel na escala de comprimento, por exemplo, a dispers√£o dada pela vari√¢ncia estar√° na escala de √°rea;
- torna-se dif√≠cil a percep√ß√£o de dispers√£o quando observamos os dados. 


## Desvio padr√£o {background-image="cap02.png"}

<font size="+3">

**Defini√ß√£o (Desvio padr√£o):** O desvio padr√£o √© definido por:
  \begin{align}\label{eq:desvpad1}
    \sigma & = \sqrt{\sigma^2}, \quad \textrm{(Popula√ß√£o)}
  \end{align}
  em que $\sigma$ √© apresentado anteriormente,
  \begin{align}\label{eq:desvpad2}
    S & = \sqrt{S^2}, \quad \textrm{(Amostra)}
  \end{align}
  em que $S$ √© apresentado anteriormente.

</font>

## Exemplo motivacional {background-image="cap02.png"}

Retornando ao Exemplo motivacional, podemos ent√£o calcular os desvios padr√µes dos grupos, que segue:

. . .

- Desvio padr√£o amostral para o grupo gA:

. . . 

\begin{align*}
    S_{\textrm{gA}} & = \sqrt{1,959404} = 1,399787~unid.
\end{align*}

. . . 

- Desvio padr√£o amostral para o grupo gB:
  \begin{align*}
    S_{\textrm{gB}} & = \sqrt{19,51007} = 4,41702~und.
  \end{align*}

## Exemplo motivacional {background-image="cap02.png"}

- Desvio padr√£o amostral para o grupo gC:

. . .

\begin{align*}
   S_{\textrm{gC}} & = \sqrt{19,72232} = 4,440982~und.
\end{align*}

- Considerando que as unidades dos grupos s√£o iguais, bem como as suas m√©dias, podemos concluir que o grupo gA apresenta menor dispers√£o;
- Claro que esse resultado, poderia ter sido observado pela vari√¢ncia. A diferen√ßa √© que conseguimos entender na unidade da vari√°vel essa dispers√£o.

## Usando o `leem` {background-image="cap02.png"}

<font size="+3">

Exemplo 1: Dados n√£o agrupados

. . . 

```{.r code-line-numbers="7|1-7"}
# Desvio padrao - Dados nao agrupados
d1 |> 
  new_leem(variable = 1) |> 
  sdev(grouped = FALSE)
```
```{r echo=FALSE}
# Desvio padrao - Dados nao agrupados
d1 |> 
  new_leem(variable = 1) |> 
  sdev(grouped = FALSE)
```

. . .

Exemplos 1: Dados agrupados

. . .

```{.r code-line-numbers="4|1-4"}
# Desvio padrao: Dados agrupados
d1 |> 
  new_leem(variable = 1) |> 
  sdev(grouped = TRUE)
```
```{r, echo=FALSE}
# Desvio padrao - Dados nao agrupados
d1 |> 
  new_leem(variable = 1) |> 
  sdev(grouped = TRUE)
```

</font>


## Usando o `leem` {background-image="cap02.png"}

<font size="+3">

Exemplo 2: Dados n√£o agrupados

. . . 

```{.r code-line-numbers="4|1-4"}
# Desvio padrao - Dados n√£o agrupados
d2 |> 
  new_leem(variable = 2) |> 
  sdev(grouped = FALSE)
```
```{r echo=FALSE}
# Desvio padrao - Dados n√£o agrupados
d2 |> 
  new_leem(variable = 2) |> 
  sdev(grouped = FALSE)
```

. . .

Exemplos 2: Dados agrupados

. . .

```{.r code-line-numbers="4|1-4"}
# Desvio padrao: Dados agrupados
d2 |> 
  new_leem(variable = 2) |> 
  sdev(grouped = TRUE)
```
```{r, echo=FALSE}
# Desvio padrao - Dados agrupados
d2 |> 
  new_leem(variable = 2) |> 
  sdev(grouped = TRUE)
```

</font>



## Caracter√≠sticas do desvio padr√£o {background-image="cap02.png"}

- a unidade do desvio padr√£o est√° na mesma escala da unidade da vari√°vel em estudo;
- limitada apenas as vari√°veis quantitativas;
- uma vez que a m√©dia √© sens√≠vel aos dados, o desvio padr√£o tamb√©m √© sens√≠vel, uma vez que esta depende da m√©dia;
- embora a vari√¢ncia amostral, $S^2$ seja um estimador n√£o viesado para a vari√¢ncia populacional $\sigma^2$, o desvio padr√£o amostral $S$, que √© derivado de $S^2$, √© um estimador viesado do desvio padr√£o populacional $\sigma$;

## Caracter√≠sticas do desvio padr√£o {background-image="cap02.png"}

- assim como a vari√¢ncia, o desvio padr√£o √© sempre uma medida positiva, exceto quando todos os valores s√£o iguais que resultam em uma vari√¢ncia nula;
- assim como na vari√¢ncia, quanto mais pr√≥ximo de zero o desvio padr√£o for, mas concentrado os dados est√£o em torno da m√©dia, ao passo que, √† medida que o desvio padr√£o se distancia de zero, mas disperso os dados est√£o em torno da m√©dia.


## Propriedades do desvio padr√£o {background-image="cap02.png"}

<font size="+3">

>**Teorema:** Baseado na Defini√ß√£o sobre o desvio padr√£o, e considerando $c$ uma constante, ent√£o:
>
>- Se para uma amostra $X_1$, $X_2$, $\ldots$, $X_n$, o desvio padr√£o √© dado por $S_X$, ent√£o para uma transforma√ß√£o de $Y_i = X_i \pm c$, para $i$ $=$ $1$, $2$, $\ldots$, $n$, ent√£o o novo desvio padr√£o n√£o se altera, isto √©, $S_Y = S_X$.
>
>- Se para uma amostra $X_1$, $X_2$, \ldots, $X_n$, o desvio padr√£o √© dado por $S_X$, ent√£o para uma transforma√ß√£o de $Y_i = X_i \times c$, para $i$ $=$ $1$, $2$, $\ldots$, $n$, ent√£o o novo desvio padr√£o √© dado por $S_Y = S_X \times c$. Esse resultado vale tamb√©m para a transforma√ß√£o $Y_i = X_i / m$, sendo $m$ tamb√©m uma constante. Basta usar $c = 1 / m$ e o resultado √© o mesmo.

</font>

# Coeficiente de varia√ß√£o (CV) {background-image="cap02.png"}

Limita√ß√µes da vari√¢ncia e desvio padr√£o:

. . .

- Os grupos de observa√ß√µes devem estar na mesma unidade de mensura√ß√£o;
- A m√©dia desses grupos devem ser iguais.

## Coeficiente de varia√ß√£o (CV) {background-image="cap02.png"}

<font size="+3">

**Defini√ß√£o (CV):** O coeficiente de varia√ß√£o √© definido por:
  \begin{align}\label{eq:cvpop}
    CV_p & = \frac{\sigma}{\mu} \times 100, \quad \textrm{(Popula√ß√£o)}
  \end{align}
  e
  \begin{align}\label{eq:cvamost}
    CV & = \frac{S}{\bar{X}} \times 100. \quad \textrm{(Amostra)}
  \end{align}

</font>

## Exemplo Coeficiente de varia√ß√£o {background-image="cap02.png"}

</br>
</br>

|Dados | Coeficiente de Varia√ß√£o ($CV$)|
|:----:|:-----------------------------:|
|gA | $CV_{\textrm{gA}} = \frac{1,399787}{9,018686} \times 100 = 15,52\%$|
| N√∫mero de erros |  $CV_{e} = \frac{1,174286}{1,7} \times 100 = 69,08\%$|

## Usando o `leem` {background-image="cap02.png"}

</br>
</br>


```{r, echo = TRUE, eval = TRUE}
gA |>
  new_leem(variable = 2) |>
  cv(grouped = FALSE)

d1 |>
  new_leem(variable = 1) |>
  cv(grouped = FALSE)

```

## Caracter√≠sticas do CV {background-image="cap02.png"}

- O $CV$ √© adimensional e uma medida de dispers√£o relativa;
- Essa medida pode ser utilizada para comparar a dispers√£o entre grupos diferentes de dados;
- Como o $CV$ √© uma medida de dispers√£o relativa, isto √©, o desvio padr√£o ponderado pela m√©dia. Isso significa que o $CV$ calcula o quanto representa a dispers√£o (o desvio padr√£o) representa √† m√©dia. Dessa forma, o $CV$ se torna limitado a vari√°veis em que a escala de mensura√ß√£o das observa√ß√µes em que fornece um zero absoluto ou uma origem significativa;

## Caracter√≠sticas do CV {background-image="cap02.png"}

- O $CV$ pode superar o 100\%. Isso ocorre quando o desvio padr√£o √© maior do a m√©dia. Dizemos que esses superdispersos, um exemplo, s√£o dados de contagem que seguem uma distribui√ß√£o de Poisson.


## Propriedades do CV

<font size="+3">

>**Teorema:** Com rela√ß√£o as propriedades do Coeficiente de Varia√ß√£o (CV), temos que:
>
>- Se para uma amostra $X_1$, $X_2$, $\ldots$, $X_n$, o coeficiente de varia√ß√£o, Defini√ß√£o anterior, ent√£o para uma transforma√ß√£o de $Y_i = X_i \pm c$, para $i$ $=$ $1$, $2$, $\ldots$, $n$ e $c$ uma constante, ent√£o o novo coeficiente de varia√ß√£o √© igual a $CV_Y = S_X / (\bar{X} \pm c) \times 100$, em que $\bar{X}$ e $S_X$ s√£o a m√©dia e o desvio padr√£o de $X_i$, $i = 1, 2, \ldots, n$;
>- Se para uma amostra $X_1$, $X_2$, $\ldots$, $X_n$, o coeficiente de varia√ß√£o, Defini√ß√£o anterior, ent√£o para uma transforma√ß√£o de $Y_i = X_i \times c$, para $i$ $=$ $1$, $2$, $\ldots$, $n$ e $c$ uma constante, ent√£o o novo coeficiente de varia√ß√£o n√£o se altera, isto √© $CV_Y = CV_X$. Esse resultado vale tamb√©m para a transforma√ß√£o $Y_i = X_i / m$, sendo $m$ tamb√©m uma constante. Basta usar $c = 1 / m$ e o resultado √© o mesmo.

</font>


# Erro padr√£o da m√©dia {background-image="cap02.png"}

- Popula√ß√£o:

. . .

**Defini√ß√£o:** Seja uma amostra $X_1$, $X_2$, \ldots, $X_n$, de uma popula√ß√£o cujos par√¢metros $\mu$ e $\sigma$, representam a m√©dia e o desvio padr√£o populacional, respectivamente, ent√£o o erro padr√£o da m√©dia, denotada por $\sigma_{\bar{X}}$, √© definido como:
\begin{align}
    \sigma_{\bar{X}} & = \frac{\sigma}{\sqrt{n}},
\end{align}
em que $n$ representa o tamanho da amostra.

## Erro padr√£o da m√©dia {background-image="cap02.png"}

- Amostra:

. . .

**Defini√ß√£o:** Seja uma amostra $X_1$, $X_2$, \ldots, $X_n$, de uma popula√ß√£o cujos par√¢metros $\mu$ e $\sigma$, representam a m√©dia e o desvio padr√£o populacional, respectivamente, ent√£o o erro padr√£o da m√©dia, denotada por $\sigma_{\bar{X}}$, √© definido como:
\begin{align}
    S_{\bar{X}} & = \frac{S}{\sqrt{n}},
\end{align}
em que $n$ representa o tamanho da amostra, e $S$ √© o desvio padr√£o da Defini√ß√£o anterior.

## Exemplo {background-image="cap02.png"}

<font size="+2">

Retornando ao Exemplo de motiva√ß√£o, podemos ent√£o calcular os erros padr√µes da m√©dia para as tr√™s amostras, que segue:

- Erro padr√£o da m√©dia amostral para o grupo gA:
  \begin{align*}
    S_{\bar{X}_{\textrm{gA}}} & = 1,399787 / \sqrt{10} = 0,442652~unid.
  \end{align*}
- Erro padr√£o da m√©dia amostral para o grupo gB:
  \begin{align*}
    S_{\bar{X}_{\textrm{gB}}} & = 4,41702 / \sqrt{10} = 1,396784~und.
  \end{align*}
- Erro padr√£o da m√©dia amostral para o grupo gC:
  \begin{align*}
   S_{\bar{X}_{\textrm{gC}}} & = 4,440982 / \sqrt{10} = 1,404362~und.
  \end{align*}
</font>

. . .

<font size="+2">
Percebemos que a m√©dia de gA estima melhor o par√¢metro $\mu$, uma vez que o erro padr√£o da m√©dia foi o menor dentre os demais.
</font>

## Usando o `leem` {background-image="cap02.png"}

</br>
</br>


```{r, echo = TRUE, eval = TRUE}
gA |>
  new_leem(variable = 2) |>
  mstde(grouped = FALSE, rounding = 6)

gB |>
  new_leem(variable = 2) |>
  mstde(grouped = FALSE, rounding = 6)

gC |>
  new_leem(variable = 2) |>
  mstde(grouped = FALSE, rounding = 6)

```


# Quest√µes? {background-image="cap02.png"}

[D√∫vidas e Sugest√µes](https://bendeivide.github.io/){preview-link="true"}

[Contato](https://bendeivide.github.io/#contact){preview-link="true"}

# Pr√≥ximas aulas {data-transition="zoom" background-image="cap02.png"}

<a href="https://bendeivide.github.io/courses/epaec/" target="_blank" style="text-align: center;">

<img src="ben.png" width = "400">

</a> <center> <a href="/courses/epaec"  target="_blank" >bendeivide.github.io/courses/epaec</a> </center>

# Refer√™ncias {background-image="cap02.png"}




<!-- 

::: {.notes} 

üìù Mostrar a rela√ß√£o do M√©todo cient√≠fico com as Defini√ß√µes gerais da estat√≠stica (Smoothdraw)

:::



:::: {.columns}

::: {.column width="90%"}

```{r echo=TRUE, eval = TRUE}
library(leem)
atot <- c(1245870, 903207.02, 237765.20, 1559167.89,
          276419.84, 164123.96, 277466.76, 223644.53, 142470.76)
atot |>
  new_leem(variable = 2) # ou new_leem(variable = "continuous")
```

```{r echo=TRUE, eval = TRUE}
library(leem)
atot <- c(1245870, 903207.02, 237765.20, 1559167.89,
          276419.84, 164123.96, 277466.76, 223644.53, 142470.76)
atotleem <- new_leem(atot, variable = 2) # ou new_leem(variable = "discrete")
atotleem
class(atotleem)
```

:::

::: {.column width="10%"}

<center>

<img src="leem.png" title="Imagens: Logo leem" width = "500">

</center>

:::

::::



::: {.nonincremental}

-   Introdu√ß√£o
    -   Nossa vida atual √© assim hoje!

:::


-->